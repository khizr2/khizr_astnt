<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Khizr Assistant</title>

<!-- External Stylesheets -->
<!-- CSS -->
<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="/css/components.css">
<link rel="stylesheet" href="/css/animations.css">

<!-- JS -->
<script src="/js/config.js" defer></script>
<script src="/js/api.js" defer></script>
<script src="/js/auth.js" defer></script>
<script src="/js/ui.js" defer></script>
<script src="/js/app.js" defer></script>

</head>
<body class="theme-purple">

<div class="container">
<!-- Header with Agent Status -->
<header class="header">
<div class="agent-status" id="agentStatus">
<div class="agent-indicator" id="browserAgent" title="Browser Agent"></div>
<div class="agent-indicator" id="coderAgent" title="Coder Agent"></div>
<div class="agent-indicator" id="pmAgent" title="PM Agent"></div>
<div class="agent-indicator" id="researchAgent" title="Research Agent"></div>
</div>

  <!-- Preference Indicators -->
  <div id="preferenceIndicators" class="preference-indicators">
    <!-- Dynamic preference badges will appear here -->
  </div>

  <div class="header-controls">
    <div class="theme-toggle">
      <button class="theme-btn purple active" onclick="typeof setTheme === 'function' && setTheme('purple')"></button>
      <button class="theme-btn red" onclick="typeof setTheme === 'function' && setTheme('red')"></button>
    </div>
    <button class="approvals-btn notification-badge" data-count="0" onclick="typeof showView === 'function' && showView('approvals')" id="approvalsHeaderBtn" title="Approvals">
      🔔
    </button>
    <button class="preference-btn" onclick="typeof showPreferenceModal === 'function' && showPreferenceModal()" title="Preference Settings">⚙️</button>
    <button class="logout-btn" onclick="typeof logout === 'function' && logout()" title="Logout">🚪</button>
  </div>

  <!-- Daddy Agent Controls -->
  <div class="daddy-controls" style="margin-top: 10px;">
    <button class="btn btn-small" onclick="typeof toggleDaddyMonitoring === 'function' && toggleDaddyMonitoring()" id="daddyToggle">
        👨‍👧 Toggle Daddy Mode
    </button>
    <button class="btn btn-small" onclick="typeof showDaddyAnalytics === 'function' && showDaddyAnalytics()">
        📈 Analytics
    </button>
  </div>
</header>

<!-- Navigation -->
<nav class="nav">
    <button class="nav-btn active" onclick="typeof showView === 'function' && showView('today')">today</button>
<button class="nav-btn" onclick="typeof showView === 'function' && showView('projects')">projects</button>
<button class="nav-btn" onclick="typeof showView === 'function' && showView('goals')">goals</button>
<button class="nav-btn" onclick="typeof showView === 'function' && showView('agents')">agents</button>
<button class="nav-btn" onclick="typeof showView === 'function' && showView('chat')">ai chat</button>
<button class="nav-btn" onclick="typeof showView === 'function' && showView('emails')">emails</button>
</nav>

<!-- Today View -->
<div id="today-view" class="today-view">
<div class="main-content">
<!-- Date Display -->
<div class="code-card">
<div class="section-header">today</div>
<div class="date-display" id="dateDisplay"></div>
</div>

<!-- Dynamic Tasks -->
<div class="code-card" id="tasksContainer">
<div class="section-header">
tasks
<button class="add-btn" onclick="typeof showAddTaskModal === 'function' && showAddTaskModal()">+ add</button>
</div>
<ul class="task-list" id="tasksList">
<!-- Tasks will be loaded dynamically -->
</ul>
</div>

<!-- AI Input -->
<div class="code-card" style="background: transparent; border: none; box-shadow: none;">
<div class="section-header" style="color: var(--text-secondary); font-size: 11px;">quick process</div>
<div class="ai-input-container" style="border: none; padding: 0;">
<div class="ai-prompt" style="color: var(--text-secondary); font-size: 12px; margin-bottom: 8px;">tell me what's on your mind</div>
<textarea
class="ai-textarea"
placeholder="? research question | zz task | !! urgent | og preserve note"
id="aiNote"
style="border: 1px solid var(--border); background: var(--bg);"
></textarea>
<button class="ai-send-btn" onclick="typeof processAINote === 'function' && processAINote()" style="background: var(--primary); color: white; border: none; font-size: 12px;">run</button>
</div>
</div>
</div>

<div class="sidebar">
<!-- Agent Status -->
<div class="code-card">
<div class="section-header">agents</div>
<div id="agentCards">
<!-- Agent status cards will be loaded here -->
</div>
</div>

<!-- Running Tasks -->
<div class="code-card">
<div class="section-header">running tasks</div>
<div id="runningTasks">
<!-- Currently running tasks will be loaded here -->
</div>
</div>

<!-- Time-bound Events -->
<div class="code-card">
<div class="section-header">timebound</div>
<ul class="time-list" id="timeEvents">
<!-- Calendar events will be loaded here -->
</ul>
</div>

<!-- Quick Actions -->
<div style="margin-top: 20px;">
<button class="mind-btn" onclick="typeof showMindPage === 'function' && showMindPage()" style="background: transparent; border: 1px solid var(--border); color: var(--text-primary); font-size: 13px; padding: 8px 16px; border-radius: 4px;">
   on my mind
</button>
</div>
</div>
</div>

<!-- Other Views -->
<div id="project-view" class="project-view">
<div class="code-card boxed">
<div class="section-header" style="display: flex; justify-content: space-between; align-items: center;">
<div style="display: flex; align-items: center; gap: 12px;">
<span>projects</span>
<!-- Sort Controls -->
<div class="sort-controls" style="display: flex; gap: 4px;">
<button class="sort-btn" onclick="typeof sortProjects === 'function' && sortProjects('name')" title="Sort by name" id="sortName">📝</button>
<button class="sort-btn" onclick="typeof sortProjects === 'function' && sortProjects('date')" title="Sort by date" id="sortDate">📅</button>
<button class="sort-btn" onclick="typeof sortProjects === 'function' && sortProjects('priority')" title="Sort by priority" id="sortPriority">⭐</button>
</div>
</div>
<button class="add-btn" onclick="typeof showAddProjectModal === 'function' && showAddProjectModal()" title="New Project" style="background: var(--primary); border: none; border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; font-size: 16px; cursor: pointer;">+</button>
</div>
<div class="project-list" id="projectList">
<!-- Projects will be loaded dynamically -->
</div>
</div>
</div>

<!-- Approvals View -->
<div id="approvals-view" class="approvals-view">
<div class="code-card boxed">
<div class="section-header">approvals needed</div>
<div id="approvalsList">
<!-- Pending approvals will be loaded here -->
</div>
</div>
</div>

<div id="goals-view" class="goals-view">
<div class="code-card boxed">
<div class="section-header">goals</div>
<p>Goals tracking coming soon...</p>
</div>
</div>

<!-- AI Agent Dashboard -->
<div id="agents-view" class="agents-view">
<div class="code-card boxed">
<div class="section-header">🤖 AI Agent Dashboard</div>

<!-- Agent Status Overview -->
<div class="agent-dashboard-grid">
<div class="dashboard-card">
<h3>Agent Status</h3>
<div id="agentStatusOverview">
<!-- Agent status will be loaded here -->
</div>
</div>

<div class="dashboard-card">
<h3>Decision Tree</h3>
<div id="decisionTree">
<!-- Decision tree visualization will be loaded here -->
</div>
</div>

<div class="dashboard-card">
<h3>Recent Activity</h3>
<div id="agentActivity">
<!-- Agent activity history will be loaded here -->
</div>
</div>

<div class="dashboard-card">
<h3>Performance Metrics</h3>
<div id="agentMetrics">
<!-- Performance metrics will be loaded here -->
</div>
</div>
</div>

<!-- Agent Control Panel -->
<div class="agent-controls">
<h3>Agent Controls</h3>
<div class="control-buttons">
<button class="btn-primary" onclick="typeof refreshAgentStatus === 'function' && refreshAgentStatus()">🔄 Refresh Status</button>
<button class="btn-secondary" onclick="typeof showAgentAnalytics === 'function' && showAgentAnalytics()">📊 Analytics</button>
<button class="btn-secondary" onclick="typeof showDaddyControls === 'function' && showDaddyControls()">👨‍👧 Daddy Controls</button>
</div>
</div>
</div>
</div>

<div id="mind-view" class="mind-view">
<div class="code-card boxed">
<div class="section-header">on my mind</div>
<textarea
id="mindInput"
class="mind-textarea"
placeholder="Share your thoughts, ideas, concerns..."
></textarea>
<button class="mind-save-btn" onclick="typeof saveMindNote === 'function' && saveMindNote()">save thought</button>
</div>
</div>

  <!-- AI Chat View -->
<div id="chat-view" class="chat-view">
<div class="code-card boxed">
<div class="section-header">ai chat</div>
<div class="chat-container">
<div class="chat-tabs">
<button class="chat-tab active" onclick="switchChatTab('main')">Main</button>
<button class="chat-tab" onclick="switchChatTab('tasks')">Tasks</button>
<button class="chat-tab" onclick="switchChatTab('projects')">Projects</button>
<button class="chat-tab" onclick="switchChatTab('research')">Research</button>
</div>
<div class="chat-messages" id="chatMessages">
<!-- Chat history will be loaded here -->
</div>
<div class="chat-input-container">
  <!-- Add AI model selector -->
  <div class="ai-model-selector" style="margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
    <label for="aiModel" style="font-size: 11px; color: var(--text-secondary);">AI Model:</label>
    <select id="aiModel" style="padding: 4px 8px; border: 1px solid var(--border); border-radius: 4px; background: var(--bg-card); color: var(--text-primary); font-size: 12px;">
      <!-- Free Models - DeepSeek Family -->
      <optgroup label="🔥 FREE - DeepSeek (Best Reasoning)">
        <option value="deepseek/deepseek-r1:free">DeepSeek R1 0528 (Best Reasoning)</option>
        <option value="deepseek/deepseek-v3-0324:free">DeepSeek V3 0324 (Balanced)</option>
        <option value="tng/deepseek-r1t2-chimera:free">DeepSeek R1T2 Chimera (Fast Reasoning)</option>
        <option value="deepseek/deepseek-r1">DeepSeek R1 (Open Source)</option>
        <option value="deepseek/deepseek-v3.1">DeepSeek V3.1 (Hybrid)</option>
      </optgroup>

      <!-- Free Models - Other Providers -->
      <optgroup label="🆓 FREE - Other Providers">
        <option value="z-ai/glm-4.5-air:free">GLM 4.5 Air (Agent Focused)</option>
        <option value="qwen/qwen3-coder-480b-a35b:free">Qwen3 Coder 480B (Code Expert)</option>
        <option value="tng/deepseek-r1t-chimera:free">DeepSeek R1T Chimera (Efficient)</option>
        <option value="moonshotai/kimi-k2:free">Kimi K2 (MoE Expert)</option>
      </optgroup>

      <!-- Premium Models -->
      <optgroup label="💎 PREMIUM - Paid Models">
        <option value="anthropic/claude-3.5-sonnet">Claude 3.5 Sonnet (Best Quality)</option>
        <option value="anthropic/claude-3-haiku">Claude 3 Haiku (Fast & Cheap)</option>
        <option value="openai/gpt-4o">GPT-4o (Latest OpenAI)</option>
        <option value="openai/gpt-4o-mini">GPT-4o Mini (Cheapest)</option>
        <option value="google/gemini-pro-1.5">Gemini Pro 1.5 (Google)</option>
        <option value="meta-llama/llama-3.1-70b-instruct">Llama 3.1 70B (Open Source)</option>
        <option value="mistralai/mistral-large">Mistral Large (Capable)</option>
      </optgroup>
    </select>
  </div>

<textarea
class="chat-input"
id="chatInput"
placeholder="Type your message or use prefixes: ? zz og !!"
onkeypress="handleChatKeyPress(event)"
oninput="autoResizeTextarea(this)"
></textarea>
<button class="chat-send-btn" id="chatSendBtn" onclick="typeof sendChatMessage === 'function' && sendChatMessage()">Send</button>
</div>
</div>
</div>
</div>

<!-- Email View -->
<div id="emails-view" class="emails-view">
<div class="code-card boxed">
<div class="section-header">emails</div>
<div class="emails-controls" style="margin-bottom: 20px;">
<button class="btn-primary" onclick="typeof connectGmail === 'function' && connectGmail()" id="gmailConnectBtn">
Connect Gmail
</button>
<button class="btn-secondary" onclick="typeof refreshEmails === 'function' && refreshEmails()" id="refreshEmailsBtn" style="display:none;">
Refresh
</button>
<span id="emailStatus" style="margin-left: 12px; font-size: 11px; color: var(--text-secondary);"></span>
</div>
<div class="emails-list" id="emailsList">
<p>Click "Connect Gmail" to start managing your emails...</p>
</div>
</div>
</div>

</div>

<!-- Add Task Modal -->
<div id="addTaskModal" class="modal-overlay" style="display: none;">
<div class="modal">
<div class="modal-header">
<h3 class="modal-title">Add New Task</h3>
<button class="modal-close" onclick="closeModal('addTaskModal')">×</button>
</div>
<form onsubmit="submitTask(event)">
<div class="form-group">
<label class="form-label">Task Title</label>
<input type="text" class="form-input" id="taskTitle" required>
</div>
<div class="form-group">
<label class="form-label">Priority</label>
<select class="form-input" id="taskPriority">
<option value="normal">Normal</option>
<option value="urgent">Urgent</option>
<option value="low">Low</option>
</select>
</div>
<div class="form-group">
<label class="form-label">Assign To</label>
<select class="form-input" id="taskAssignTo">
<option value="human">Me</option>
<option value="browser_agent">Browser Agent</option>
<option value="coder_agent">Coder Agent</option>
<option value="pm_agent">PM Agent</option>
<option value="researcher_agent">Research Agent</option>
</select>
</div>
<div class="form-group">
<label class="form-label">Description (optional)</label>
<textarea class="form-textarea" id="taskDescription" placeholder="Additional details..."></textarea>
</div>
<div class="form-buttons">
<button type="button" class="btn-secondary" onclick="closeModal('addTaskModal')">Cancel</button>
<button type="submit" class="btn-primary">Add Task</button>
</div>
</form>
</div>
</div>

<!-- Add Project Modal -->
<div id="addProjectModal" class="modal-overlay" style="display: none;">
<div class="modal">
<div class="modal-header">
<h3 class="modal-title">Add New Project</h3>
<button class="modal-close" onclick="closeModal('addProjectModal')">×</button>
</div>
<form onsubmit="submitProject(event)">
<div class="form-group">
<label class="form-label">Project Name</label>
<input type="text" class="form-input" id="projectName" required>
</div>
<div class="form-group">
<label class="form-label">Description</label>
<textarea class="form-textarea" id="projectDescription" placeholder="What is this project about?"></textarea>
</div>
<div class="form-group">
<label class="form-label">Due Date (optional)</label>
<input type="date" class="form-input" id="projectDueDate">
</div>
<div class="form-buttons">
<button type="button" class="btn-secondary" onclick="closeModal('addProjectModal')">Cancel</button>
<button type="submit" class="btn-primary">Add Project</button>
</div>
</form>
</div>
</div>

<!-- Preference Management Modal -->
<div id="preferenceModal" class="modal-overlay" style="display: none;">
<div class="modal">
<div class="modal-header">
<h3 class="modal-title">AI Preferences & Learning</h3>
<button class="modal-close" onclick="closeModal('preferenceModal')">×</button>
</div>
<div class="preference-content">
<div class="preference-section">
<h4 style="color: var(--text-accent); font-size: 13px; margin-bottom: 12px;">🧠 Pattern Intelligence</h4>
    <div id="patternInsights" class="pattern-insights">
    <div class="pattern-metric">
        <span class="metric-label">💬 Your Communication Style</span>
        <span class="metric-value" id="commStyle">Learning...</span>
    </div>
    <div class="pattern-metric">
        <span class="metric-label">⚡ Your Most Productive Hours</span>
        <span class="metric-value" id="peakHours">Learning...</span>
    </div>
    <div class="pattern-metric">
        <span class="metric-label">🎯 Task Completion Rate</span>
        <span class="metric-value" id="completionRate">Learning...</span>
    </div>
    <div class="pattern-metric">
        <span class="metric-label">👨‍👧 Daddy Agent</span>
        <span class="metric-value" id="daddyStatus">Active</span>
    </div>
</div>
<button class="btn-secondary" style="margin-top: 12px;" onclick="typeof showPatternInsights === 'function' && showPatternInsights()" title="View detailed patterns">📊 View Detailed Patterns</button>
</div>

<div class="preference-section">
<h4 style="color: var(--text-accent); font-size: 13px; margin-bottom: 12px;">💡 Smart Suggestions</h4>
<div id="suggestionList" class="suggestion-list">
    <!-- Dynamic suggestions appear here -->
</div>
</div>

<div class="preference-section">
<h4 style="color: var(--text-accent); font-size: 13px; margin-bottom: 12px;">Current Preferences</h4>
<div id="currentPreferences" class="preference-list">
<!-- Preferences will be loaded here -->
</div>
</div>

<div class="preference-section">
<h4 style="color: var(--text-accent); font-size: 13px; margin-bottom: 12px;">Preference Learning</h4>
<p style="font-size: 12px; color: var(--text-secondary); margin-bottom: 12px;">
Your preferences are automatically learned from your feedback and interaction patterns.
</p>
<div class="preference-controls">
<button class="btn-secondary" onclick="typeof resetPreferences === 'function' && resetPreferences()">Reset All Preferences</button>
<button class="btn-primary" onclick="typeof updatePreferences === 'function' && updatePreferences()">Update Preferences</button>
</div>
</div>
</div>
</div>
</div>


</body>
</html>